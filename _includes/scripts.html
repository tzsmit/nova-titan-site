<!-- JavaScript Libraries & Scripts -->

<!-- 1. Vendor Libraries (Load First with defer) -->
<script defer src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<!-- 2. Particle.js Configuration -->
<script>
  // Initialize Particles on load (deferred via event listener)
  window.addEventListener('load', function() {
    if (typeof particlesJS !== 'undefined') {
      particlesJS('particles-js', {
        particles: { 
          number: { value: 80, density: { enable: true, value_area: 1000 } },
          color: { value: ['#00d4ff', '#00ff88', '#b300ff', '#ff0066'] }, 
          shape: { type: 'circle' },
          opacity: { value: .3, random: true }, 
          size: { value: 3, random: true },
          line_linked: { enable: true, distance: 120, color: '#00d4ff', opacity: .25, width: 1 },
          move: { enable: true, speed: 1.8, direction: 'none', random: false, straight: false, out_mode: 'out', bounce: false } 
        },
        interactivity: { 
          detect_on: 'canvas',
          events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' } }, 
          modes: { repulse: { distance: 80, duration: 0.4 }, push: { particles_nb: 3 } } 
        },
        retina_detect: true
      });
    }
  });
</script>

<!-- 3. GSAP Animations -->
<script>
  // Wait for all scripts to load before initializing (deferred via event listener)
  window.addEventListener('load', function() {
    // Fallback: Ensure all content is visible even if GSAP fails
    setTimeout(function() {
      document.querySelectorAll('.fade-in, .card').forEach(function(el) {
        el.style.opacity = '1';
      });
    }, 100);
    
    // GSAP animations DISABLED to prevent layout shift issues
    // The translateY animations were causing content to jump/shift up after page load
    if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {
      try {
        // Just ensure all elements are visible, no animations
        const cards = document.querySelectorAll('.card');
        if (cards.length > 0) {
          cards.forEach(card => card.style.opacity = '1');
        }

        const fadeElements = document.querySelectorAll('.fade-in');
        if (fadeElements.length > 0) {
          fadeElements.forEach(el => {
            el.style.opacity = '1';
          });
        }
        
        const portfolioCards = document.querySelectorAll('.portfolio-preview');
        if (portfolioCards.length > 0) {
          portfolioCards.forEach(card => {
            card.style.opacity = '1';
          });
        }
        
        // All GSAP from() animations commented out to prevent layout shift
        // Original code caused content to translateY upward after page load
        // This was the root cause of heading/content overlaps
      } catch (error) {
        console.error('GSAP initialization error:', error);
        // Ensure everything is visible on error
        document.querySelectorAll('.fade-in, .card').forEach(function(el) {
          el.style.opacity = '1';
        });
      }
    } else {
      console.warn('GSAP or ScrollTrigger not loaded - showing all content');
      // Ensure everything is visible when GSAP not loaded
      document.querySelectorAll('.fade-in, .card').forEach(function(el) {
        el.style.opacity = '1';
      });
    }
  });
</script>

<!-- 4. Navigation Script (Must load after GSAP/Particles) -->
<script defer src="/assets/js/nav.js"></script>

<!-- 5. Page-specific scripts -->
{% if page.extra_scripts %}
  {{ page.extra_scripts }}
{% endif %}

<!-- 6. Console Branding -->
<script>
  console.log('%cüõ°Ô∏è {{ site.title }}', 'color: #b300ff; font-size: 18px; font-weight: bold;');
  console.log('%cIT Consulting ¬∑ Network Security ¬∑ Managed Support', 'color: #00d4ff; font-size: 14px;');
  console.log('%cServing Lubbock & West Texas ¬∑ Remote Services Nationwide', 'color: #00ff88; font-size: 12px;');
</script>
